#!/bin/bash

# ========= DIALOG-ENHANCED SERVER MANAGEMENT REMOVE =========

# --- Check if running as root ---
if [[ "$(id -u)" -ne 0 ]]; then
    dialog --title "Permission Denied" --msgbox "This program must be run as root.\nExiting..." 8 50
    clear
    exit 1
fi

# --- Introduction Message ---
dialog --title "Server Management Removal" --msgbox \
"Server Management (SM-GUI) will be removed from starting automatically at root login.

You can still start it anytime by typing 'server-manager' in the CLI." 10 100

# --- Confirmation Prompt ---
dialog --title "Disable SM on Boot?" --yesno \
"Do you want to disable Server Management on boot?" 7 60

CONFIRM=$?

if [[ $CONFIRM -eq 0 ]]; then
    # --- Remove entry from .bash_profile ---
    if grep -q 'server-manager' /root/.bash_profile; then
        sed -i '/server-manager/d' /root/.bash_profile
        dialog --title "Success" --msgbox "Server Management removed from autostart." 6 50
    else
        dialog --title "Info" --msgbox "No autostart entry found. Nothing to remove." 6 50
    fi
    clear
    exit 0
else
    dialog --title "Cancelled" --msgbox "Operation cancelled. No changes made." 6 50
    clear
    exit 0
fi
